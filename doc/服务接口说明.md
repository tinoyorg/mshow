# mshow接口说明

**包含模块**

- 用户模块（user、staff、admin）
- 展馆模块exhibition
- 展览模块show
- 展品模块collection

**接口信息**

- 协议：HTTPS
- 项目名：mshow
- 最新版本：v1.1
- 更新内容：规范了参数格式和有关单词，及添加使用了TOKEN进行用户认证

**接口说明**

- **参数** : 需要在url中使用到的参数
- **body数据** : 需要在请求的body传递的data数据
- **header数据** ： 标注了header数据的需要在请求和响应的请求头中添加以下数据
  - **token** : String  存在请求头中，用户令牌，后续请求中用户访问控制

## 元数据及其他接口

### 测试连通性

GET	/test

- 请求示例：

  ```
   GET /test
  ```

- 响应示例：

  ```
  {
      "status": "success",
      "info": "Hello, world!"
  }
  ```



## 用户模块

有关用户模块的相关接口 



### 内容搜索

根据展馆名、展览名、展品名进行搜索

GET	/search/query?{搜索参数}

**参数**

- **query**  :String    根据展馆、展览、展品进行搜索 
- **type** : String 搜索分类（展馆、展览、展品）
- **page** （可选） :Integer    第几页，默认值：1  
- **Integer**（可选）  每页显示多少条，默认值：5

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **total_page** : Integer  总页数，当next_page大于total_pages时表示不再有数据   
- **next_page** : Integer  下一页索引 
- **data** : 返回的数据
  - **item_list** : Object[]  搜索结果列表
    - item_id : Integer 结果id
    - item_name : String 结果名称
    - item_type : String 结果类型（展馆、展览、展品）
    - item_image : String 结果图片

**错误 4xx**

- ValidationError  输入字段验证出错，缺少字段或字段格式有误（详见?message）



### 用户登录

小程序登录  本接口使用微信服务器进行登录到mshow

POST	/user/login

**数据**

- **code** : String  wx.login()获取到的code
- **encryptedData** ：String wx.getUserInfo()获得的res.encryptedData 用户敏感信息加密数据
- **iv** ：String wx.getUserInfo()获得的res.iv 加密算法的初始向量 

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** : String 返回有关的说明
- **token** : String 用户令牌，后续请求中用户访问控制
- **ttl** : Integer token有效期，单位秒



### 用户信息初始化

小程序登录  本接口使用微信服务器进行登录到mshow

POST	/user/user_info

**数据**

- **session**
- **encryptedData** ：String wx.getUserInfo()获得的res.encryptedData 用户敏感信息加密数据
- **iv** ：String wx.getUserInfo()获得的res.iv 加密算法的初始向量 

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** : String 返回有关的说明
- **ttl** : Integer token有效期，单位秒
- **token** : String 用户令牌，后续请求中用户访问控制



### 用户信息

对于用户信息进行操作

#### 获取用户信息

获取用户相应的信息

GET	/user/user_info

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：String  响应结果，正常情况下为success
- **msg** :  String  响应说明
- **token** : String 用户令牌，后续请求中用户访问控制
- **data** : 
  - **userInfo** : Object 用户信息
    - **user_id** : Integer 用户唯一的标识
    - **user_nick** ： String 用户昵称
    - **user_name** ： String 用户姓名
    - **role ** : integer 0为普通用户，1为馆员，2为馆长
    - **appointment_id** : Integer 用户预约展览记录id
    - **collection_count** : Integer 收藏的数量
    - **collections** : Object[] 收藏列表



#### 修改用户信息

PUT	/user/user_info

**参数**

- **user_name** (可选) : String   用户姓名
- **user_sex**(可选) ： String   用户性别
- **user_location**(可选) ：String   用户性别

**header数据**

**token** : String 用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** : 
  - **object** ： Object 用户信息，字段说明见获取用户信息接口





### 用户行为

#### 查询预约记录

查询并返回用户相关的预约记录

GET 	/user/appointment_list



**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** : 
  - **appointment_id** : Integer 预约记录id
  - **user** : Object 预约记录的用户
  - **appointment_count** : Integer 预约记录包含的展览数量
  - **appointment_list**: Object[] 预约记录中包含的展览
    - object: Object  某一个预约记录中对象
    - appointment: Object 某一个预约记录

**错误 4xx**

InvalidToken 未登录或授权过期，请登录

```
HTTP/1.1 401 Unauthorized
{
  "code": "InvalidToken",
  "message": "未登录或授权过期，请登录"
}
```



#### 查询浏览记录

查询并返回用户相关的浏览记录

GET 	/user/record_list

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** : 
  - **record_id** : Integer 浏览记录id
  - **user** : Object 预约记录的用户
  - **record_count** : Integer 预约记录包含的展览数量
  - **record_list**: Object[] 预约记录中包含的展览
    - object: Object  某一个浏览记录中对象
    - record: Object 某一个浏览记录

**错误 4xx**

InvalidToken 未登录或授权过期，请登录

```
HTTP/1.1 401 Unauthorized
{
  "code": "InvalidToken",
  "message": "未登录或授权过期，请登录"
}
```



#### 获取当前所有评论

GET	/user/comment_list/object_type/{object_type}/object_id/{object_id}

**参数**

- **object_id** : Integer 对象id
- **object_type** ： String  对象类型
- **page** (可选) : Integer 请求分页索引，默认值1
- **per_page ** (可选) : Integer 每页返回的数据条数，默认值10

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **next_page** :Integer 下一页索引 
- **total_pages**  :  Integer总页数，当next_page大于total_pages时表示不再有数据
- **msg** :  String  响应说明
- **data** :
  - **comment_list** :Object[]  评论列表  
    - **comment_id**: String  评论id
    - **content** :String   评论内容
    - **create_at_format**  :String  格式化后的评论时间       
    - **user_id**  : Integer  评论用户的id
    - **user_name** : String  评论用户的用户名 
    - **sub_comments_count** : Integer 子评论数量
    - **sub_comment_list**(可选) : Object[] 子评论列表
      - **comment_id**: String  评论或回复id
      - **content** :String   评论或回复的日记，语音评论时为空
      - **create_at_format**  :String  格式化后的评论时间    
      - **user_id**  : Integer  评论用户的id
      - **user_name** : String  评论用户的用户名
      - **to_user_id** : Integer,评论被回复的用户id
      - **to_user_name** : String  评论被回复的用户名

**错误 4XX**

- **NotFound**   message：该展馆不存在



#### 发布评论

发布有关展馆的评论

POST	/user/object_type/{object_type}/object_id/{object_id}/comment

**参数**

- **token** : String 用户令牌，后续请求中用户访问控制
- **object_id** : Integer 对象id
- **object_type** ： String  对象类型
- **content** : String 评论内容

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success

- **msg** :  String  响应说明

- **data** :

  - **user**  : Object  评论用户

  - **comment**: Object 评论id

    - **content** :String   评论内容

    - **object_id** : Integer 对象id

    - **object_type** ： String  对象类型

    - **create_at_format**  :String  格式化后的评论时间       

      

**错误 4xx**

- **ValidationError** 	message：输入字段验证出错，缺少字段或字段格式有误（评论内容不能为空，只能评论一次）
- **InvalidToken**     message：未登录或授权过期，请登录
- **NotFound**   message：该展馆不存在



#### 删除评论

删除展馆有关评论

DELETE	/user/object_type/{object_type}/object_id/{object_id}/comment/{comment_id}

**参数**

- **object_id** : Integer 对象id
- **object_type** ： String  对象类型
- **comment_id** : Integer  评论id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**错误 4xx**

- **InvalidToken**     message：未登录或授权过期，请登录
- **NotFound**   message：该展馆或评论不存在





#### 用户点赞

用户对展馆、展览、展品进行点赞

POST	/user/like

**参数**

- **like_type** ：Integer 类型 1展馆、2展览、3展品 取值范围1,2,3
- **like_type_id** ：Integer 类型id，比如展馆时为exhibition_id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** : 
  - **like_count** : integer 对象被点赞数

**错误 4xx**

- **ValidationError** 	message：输入字段验证出错，缺少字段或字段格式有误（类型取值不正确）
- **InvalidToken**     message：未登录或授权过期，请登录
- **NotFound**   message：该展馆/展览/展品不存在



#### 取消点赞

DELETE	/user/like

**参数**

- **like_type** ：Integer 类型 1展馆、2展览、3展品 取值范围1,2,3
- **like_type_id** ：Integer 类型id，比如展馆时为exhibition_id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success

- **msg** :  String  响应说明

- **token** : String 用户令牌，后续请求中用户访问控制

  

**错误 4xx**

- **ValidationError** 	message：输入字段验证出错，缺少字段或字段格式有误（无效数据参数）
- **InvalidToken**     message：未登录或授权过期，请登录



#### 新增收藏

用户对展馆、展览、展品进行收藏

POST	/user/star

**参数**

- **star_type** ：Integer 类型 1展馆、2展览、3展品 取值范围1,2,3
- **star_type_id** ：Integer 类型id，比如展馆时为exhibition_id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success

- **msg** :  String  响应说明

- **token** : String 用户令牌，后续请求中用户访问控制

- **data** : 

  - **star_count** : integer 对象被收藏数

  

#### 取消收藏

DELETE	/user/star/{star_type_id}

**参数**

- **star_type** ：Integer 类型 1展馆、2展览、3展品 取值范围1,2,3
- **star_type_id** ：Integer 类型id，比如展馆时为exhibition_id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明

**错误 4xx**

- **ValidationError** 	message：输入字段验证出错，缺少字段或字段格式有误（无效数据参数）
- **InvalidToken**     message：未登录或授权过期，请登录



#### 分享

？调用微信分享对于展馆、展览、展品进行分享

GET  /user/share/{share_type}/type/{share_type_id}

**参数**

- **share_type** ：Integer 类型 1展馆、2展览、3展品 取值范围1,2,3
- **share_type_id** ：Integer 类型id，比如展馆时为exhibition_id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **share** ：Object 分享链接
    - **url** ： String 分享链接 
    - **image**： String  分享时使用的图片ur 
    - **title**：String  标题 
    - **content** ：String  分享时的文字说明

**错误 4xx**

- **ValidationError** 	message：输入字段验证出错，缺少字段或字段格式有误
- **InvalidToken**     message：未登录或授权过期，请登录
- **NotFound**   message：该展馆/展览/展品不存在



#### 意见报告

用户对于对象（“展馆”、“展览”和“展品”)进行意见报告（投诉complaint、反馈feedback、举报accusation）

POST	/user/report/{object_id}

**参数**

- **object_id** :integer 反馈对象编号
- **object_type**: Integer  反馈对象类型 1展馆、2展览、3展品 取值范围1,2,3
- **type** : Integer 反馈类型 1投诉、2反馈、3举报取值范围1,2,3
- **content** : String  反馈内容

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **user_name** : String 用户名
  - **ojbect** : Object 被反馈报告的对象
  - **report** : Object 反馈报告

**错误 4xx**

- **ValidationError** 输入字段验证出错，缺少字段或字段格式有误，message（无效数据参数、反馈内容不能为空）



### 员工管理

#### 升级员工

用户生成相应的二维码，（由馆长验证后，升级为员工staff，role=1）

？get	/user/staffqr

？如何生成



#### 添加新员工

馆长扫描用户升级员工所生成相应的二维码，升级为员工staff，role=1

post	/user/staff

?扫描后传递的参数？

**参数**

**成功 200 OK**



#### 删除员工

馆长进行删除员工

DELETE 	/user/staff

**参数**

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **token** : String 用户令牌，后续请求中用户访问控制
- **data** :
  - **staff_list** :  Object[]  返回删除后的新员工组

**错误 4XX**

- **NotFound**   message：该展馆不存在



## 场馆模块

有关展馆模块的接口说明



### 馆长管理

#### 升级馆长(创建展馆)

用户或员工需要先填写展馆信息，创建展馆，升级为馆长admin,role=2

POST 	/exhibition/exhibition_info

**参数**

- **exhibition_name** : String 展馆名称
- **exhibition_phone** : String 展馆电话
- **exhibition_avatar** : String 展馆图片，加密后的String类型（特殊处理）
- **exhibition_position** : String 展馆地址
- **exhibition_introduce** : String 展馆简介
- **open_time** : String 开馆时间
- **end_time** ： : String 闭馆时间

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **exhibition** : Object 展馆对象
  - **role**（可选） : 返回权限（一般修改role 即auth 升级为馆长admin,role=2）

**错误 4XX**

- **CreateError**   message：该展馆已存在
- **InvalidToken**        message：未登录或授权过期，请登录
- **ValidationError**    message：输入字段验证出错，缺少字段或字段格式有误



#### 获取馆长信息

在个人信息中查看自己的馆长信息（需要先登录且需要验证是否为馆长admin,role=2）

GET	/exhibition/{exhibition_id}/exhibition_info

**参数**

- **exhibition_id** : Integer 展馆id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **exhibition** : Object 展馆对象

**错误 4XX**

- **InvalidToken**        message：未登录或授权过期，请登录



#### 更改馆长信息(更新展馆信息)

馆长修改展馆信息，需要验证是否为馆长admin,role=2

PUT	/exhibition/{exhibition_id}/exhibition_info

**参数**

- **exhibition_id** : Integer 展馆id
- **exhibition_name**（可选） : String 展馆名称
- **exhibition_phone**（可选） : String 展馆电话
- **exhibition_avatar**（可选） : String 展馆图片，加密后的String类型（特殊处理）
- **exhibition_position** （可选）: String 展馆地址
- **exhibition_introduce** （可选）: String 展馆简介
- **open_time**（可选） : String 开馆时间
- **end_time** （可选）： : String 闭馆时间

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **exhibition** : Object 展馆对象

**错误 4XX**

- **UpdateError**   message：该展馆不存在
- **InvalidToken**        message：未登录或授权过期，请登录
- **ValidationError**    message：输入字段验证出错，缺少字段或字段格式有误



#### 注销馆长(注销展馆)

馆长注销自己馆长身份，需要验证是否为馆长admin,role=2

DELETE    /exhibition/{exhibition_id}/exhibition_info

**参数**

- **exhibition_id** : Integer 展馆id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 204**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **exhibition** : Object 展馆对象
  - **role**（可选） : 返回权限（一般修改role 即auth，验证是否为馆长admin,role=2 ）

**错误 4XX**

- **NotFound**   message：该展馆不存在
- **InvalidToken**        message：未登录或授权过期，请登录



#### 统计展馆数据

馆长查看展馆的相关数据（需要登录及馆长权限）

GET	/exhibition/total_info

**参数**

- **exhibition_id** : Integer 展馆id

**成功 200 OK**

- **status**：响应结果，正常情况下为success

- **msg** :  String  响应说明

- **data** :

  - 

  

**错误 4XX**

- **NotFound**   message：该展馆不存在



### 获取展馆列表

获取展馆的列表（游客模式，不需要登录验证）

GET	/exhibition/exhibition_list

**成功 200 OK**

- **status**：响应结果，正常情况下为success

- **msg** :  String  响应说明

- **data** :

  - **exhibition_list** :  Object[]  返回当前的所有展馆列表

    - **exhibition_id** : Integer 展馆id
    - **exhibition_name** : String 展馆名称
    - **exhibition_position** : String 展馆地址
    - **exhibition_introduce** : String 展馆简介
    - **exhibition_thumb** : String 展馆图片，加密后的String类型（  Base64处理）
    - **open_time** : String 开馆时间
    - **end_time** ： : String 闭馆时间
    - **star_count** : Integer 被收藏数
    - **like_count** : Integer 点赞数
    - **share_count** : Integer 分享数

    **成功 201 Created**

  - **exhibition_count** : Integer 当前的展馆总数


**错误 4XX**

- **NotFound**   message：不存在任何展馆



### 获取展馆详情

获取某一个展馆的详情信息 （游客模式，不需要登录验证）

GET	/exhibition/{exhibition_id}/exhibition_content

**参数**

- **exhibition_id** : Integer 展馆id

**成功 200 OK**

- **status**：响应结果，正常情况下为success

- **msg** :  String  响应说明

- **data** :

  - **exhibition** :  Object  返回当前的展馆信息 详情获取展馆列表接口

  

**错误 4XX**

- **NotFound**   message：该展馆不存在



### 获取展馆内展览

获取某一个展馆的内的所有展览 （游客模式，不需要登录验证）

GET	/exhibition/{exhibition_id}/show_list

**参数**

- **exhibition_id** : Integer 展馆id

**成功 200 OK**

- **status**：响应结果，正常情况下为success

- **msg** :  String  响应说明

- **data** :

  - **show_list** :  Object[]  返回当前的所有展馆列表
    - **show_id** : Integer 展馆id
    - **show_name** : String 展馆名称
    - **show_position** : String 展馆地址
    - **show_introduce** : String 展馆简介
    - **show_thumb** : String 展馆图片，加密后的String类型（  Base64处理）
    - **open_time** : String 开馆时间
    - **end_time** ： : String 闭馆时间
    - **star_count** : Integer 被收藏数
    - **like_count** : Integer 点赞数
    - **share_count** : Integer 分享数
  - **show_count** : Integer 当前的展馆总数

  

**错误 4XX**

- **NotFound**   message：该展馆不存在任何展览



## 展览模块

有关展览模块的接口信息

### 展览信息

#### 创建展览

馆长进行创建展览，需要验证是否为馆长admin,role=2

POST 	/show/show_info

**参数**

- **show_name** : String 展览名称
- **show_position** : String 展览地址
- **show_introduce** : String 展览简介
- **show_thumb** : String 展览图片，加密后的String类型（  Base64处理）
- **open_time** : String 展览时间
- **end_time** ： : String 展览时间

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **show** : Object 展览对象

**错误 4XX**

- **CreateError**   message：该展览已存在
- **InvalidToken**        message：未登录或授权过期，请登录
- **ValidationError**    message：输入字段验证出错，缺少字段或字段格式有误



#### 更改展览信息

馆长更新展览内容，需要验证是否为馆长admin,role=2

PUT	/show/{show_id}/show_info

**参数**

- **show_id** : Integer 展览id
- **show_name**（可选） : String 展览名称
- **show_position**（可选） : String 展览地址
- **show_introduce** （可选）: String 展览简介
- **show_thumb** （可选）: String 展览图片，加密后的String类型（  Base64处理）
- **open_time**（可选） : String 展览时间
- **end_time** （可选） : String 展览时间

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **show** : Object 展览对象

**错误 4XX**

- **NotFound**   message：该展览不存在任何展品
- **InvalidToken**        message：未登录或授权过期，请登录
- **ValidationError**    message：输入字段验证出错，缺少字段或字段格式有误



#### 删除展览

馆长删除某一个展览，需要验证是否为馆长admin,role=2

DELETE    /show/{show_id}/show_info

**参数**

- **show_id** : Integer 展览id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 204**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **show** : Object 展览对象

**错误 4XX**

- **NotFound**   message：该展览不存在
- **InvalidToken**        message：未登录或授权过期，请登录



### 获取展览列表

获取所有展览的列表（游客模式，不需要登录验证）

GET	/show/show_list

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **show_list** :  Object[]  返回当前的所有展览列表
    - **show_id** : Integer 展览id
    - **show_name** : String 展览名称
    - **show_position** : String 展览地址
    - **show_introduce** : String 展览简介
    - **show_thumb** : String 展览图片，加密后的String类型（  Base64处理）
    - **open_time** : String 展览时间
    - **end_time** ： : String 展览时间
    - **star_count** : Integer 被收藏数
    - **like_count** : Integer 点赞数
    - **share_count** : Integer 分享数
  - **show_count** : Integer 当前的展览总数

**错误 4XX**

- **NotFound**   message：无任何展览



### 获取展览详情

获取某一个展览的详情信息 （游客模式，不需要登录验证）

GET	/show/{show_id}/show_content

**参数**

- **show_id** : Integer 展览id

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **show** :  Object  返回当前的展览信息 详情获取展览列表接口

**错误 4XX**

- **NotFound**   message：该展览不存在



### 获取展览内展品

获取某一个展馆的内的所有展品 （游客模式，不需要登录验证）

GET	/show/{show_id}/collection_list

**参数**

- **show_id** : Integer 展览id

**成功 200 OK**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **collection_list** :  Object[]  返回当前的所有展品列表
    - **collection_id** : Integer 展品id
    - **collection_name** : String 展品名称
    - **collection_position** : String 展品位置
    - **collection_introduce** : String展品简介
    - **collection_thumb** : String 展品图片，加密后的String类型（  Base64处理）
    - **collection_author** : String 展品作者
    - **collection_years** : String 展品年代
    - **collection_source** : String 展品来源
    - **collection_code** : String 展品编号  仅用于展示
    - **like_count** : Integer 点赞数
    - **star_count** : Integer 被收藏数
    - **share_count** : Integer 分享数
  - **collection_count** : Integer 当前的展览总数

**错误 4XX**

- **NotFound**   message：该展览不存在任何展品



### 展览预约

#### 创建展览预约

用户预约参观某一个展览（需要登录）

POST	/show/{show_id}/appointment



**参数**

- **show_id** : Integer 展览id
- **arrival_time** ：String 选择入场时间

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **appointment** : Object 预约记录对象
    - **appointment_id** : 预约记录id
    - **user_id** : Integer 预约用户id
    - **show_id** : Integer 预约展览id
    - **timestamp** :String 提交时间
    - **lastmodify** :String 修改时间
    - **book_time** :String   预定时间
    - **arrival_time**:String 入场时间
    - **status** :String 预约状态（当前为预约成功，此外还有完成，取消）

**错误 4XX**

- **CreateError**   message：该预约已存在

- **InvalidToken**        message：未登录或授权过期，请登录

  

#### 更改预约内容

用户修改预约记录，预约状态为成功（需要登录）

PUT	/show/{show_id}/appointment/{appointment_id}

**参数**

- **show_id** : Integer 展览id
- **appointment_id** : Integer 展览id
- **arrival_time** （可选）: String 入场

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **appointment** : Object 预约记录对象

**错误 4XX**

- **NotFound**   message：该预约不存在
- **InvalidToken**        message：未登录或授权过期，请登录
- **ValidationError**    message：输入字段验证出错，缺少字段或字段格式有误



#### 退订展览

用户取消预约参观某一个展览，修改预约状态为取消（需要登录）

PUT	/show/{show_id}/appointment/{appointment_id}

**参数**

- **show_id** : Integer 展览id
- **appointment_id** : Integer 展览id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **appointment** : Object 预约记录对象

**错误 4XX**

- **NotFound**   message：该预约不存在
- **InvalidToken**        message：未登录或授权过期，请登录



#### ？生成进场信息

以二维码或者编码方式生成对应的用户进程信息





#### 验证进场信息（完成预约）

员工或者管理员验证用户的进场信息，并完成预约参观某一个展览，修改预约状态为完成（需要登录）

PUT	/show/{show_id}/appointment/{appointment_id}

**参数**

- **show_id** : Integer 展览id
- **appointment_id** : Integer 展览id

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **appointment** : Object 预约记录对象

**错误 4XX**

- **NotFound**   message：该预约不存在
- **InvalidToken**        message：未登录或授权过期，请登录



## 展品模块

有关展品的接口信息

### 展品信息

#### 创建展品

馆长创建展品，需要验证是否为馆长admin,role=2

POST 	/collection/collection_info

**参数**

- **collection_name** : String 展品名称
- **collection_position** : String 展品位置
- **collection_introduce** : String展品简介
- **collection_thumb** : String 展品图片，加密后的String类型（  Base64处理）
- **collection_author** : String 展品作者
- **collection_years** : String 展品年代
- **collection_source** : String 展品来源

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **collection** : Object 展品对象

**错误 4XX**

- **CreateError**   message：该展品已存在
- **InvalidToken**        message：未登录或授权过期，请登录
- **ValidationError**    message：输入字段验证出错，缺少字段或字段格式有误



#### 更改展品信息

馆长创建展品，需要验证是否为馆长admin,role=2

PUT 	/collection/{collection_id}/collection_info

**参数**

- **collection_id** :Integer 展品ID
- **collection_name** （可选）: String 展品名称
- **collection_position** （可选）: String 展品位置
- **collection_introduce** （可选）: String展品简介
- **collection_thumb** （可选）: String 展品图片，加密后的String类型（  Base64处理）
- **collection_author**（可选） : String 展品作者
- **collection_years** （可选）: String 展品年代
- **collection_source**（可选） : String 展品来源

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 201 Created**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **collection** : Object 展品对象

**错误 4XX**

- **NotFound**   message：该展品不存在
- **InvalidToken**        message：未登录或授权过期，请登录
- **ValidationError**    message：输入字段验证出错，缺少字段或字段格式有误



#### 删除展品

馆长删除某一个展品，需要验证是否为馆长admin,role=2

DELETE    /collection/{collection_id}/collection_info

**参数**

- **collection_id** : Integer 展品id

**header数据**

- **token** : String  用户令牌，后续请求中用户访问控制

**成功 204**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **collection** : Object 展品对象

**错误 4XX**

- **NotFound**   message：该展品不存在
- **InvalidToken**        message：未登录或授权过期，请登录



### 查看展品详情

游客查看某一个展品，（不需要登录）

GET	/collection/{collection_id}/collection_content

**参数**

- **collection_id** : Integer 展品id

**成功 204**

- **status**：响应结果，正常情况下为success
- **msg** :  String  响应说明
- **data** :
  - **collection** : Object 展品对象

**错误 4XX**

- **NotFound**   message：该展品不存在